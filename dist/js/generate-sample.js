import{n as t,t as e,e as i}from"./gpt-playground.js";import{T as n,i as r,s as o,x as s,w as a,a as l,g as c,j as d}from"./url-hash.js";import{e as u,i as p,t as f,T as h,c as g,a as y,b as v,d as b}from"./base64url.js";
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function m(e){return t({...e,state:!0,attribute:!1})}
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const _={},$=u(class extends p{constructor(){super(...arguments),this.key=n}render(t,e){return this.key=t,e}update(t,[e,i]){return e!==this.key&&(((t,e=_)=>{t._$AH=e;
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */})(t),this.key=e),i}});var x="object"==typeof global&&global&&global.Object===Object&&global,j="object"==typeof self&&self&&self.Object===Object&&self,S=x||j||Function("return this")(),C=S.Symbol,w=Object.prototype,A=w.hasOwnProperty,z=w.toString,O=C?C.toStringTag:void 0,k=Object.prototype.toString,I="[object Null]",R="[object Undefined]",E=C?C.toStringTag:void 0;function T(t){return null==t?void 0===t?R:I:E&&E in Object(t)?function(t){var e=A.call(t,O),i=t[O];try{t[O]=void 0;var n=!0}catch(t){}var r=z.call(t);return n&&(e?t[O]=i:delete t[O]),r}(t):function(t){return k.call(t)}(t)}function P(t){return null!=t&&"object"==typeof t}var N=Array.isArray;function q(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var U="[object AsyncFunction]",D="[object Function]",B="[object GeneratorFunction]",V="[object Proxy]";function M(t){if(!q(t))return!1;var e=T(t);return e==D||e==B||e==U||e==V}var F,K=S["__core-js_shared__"],L=(F=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||""))?"Symbol(src)_1."+F:"",G=Function.prototype.toString;function H(t){if(null!=t){try{return G.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var J=/^\[object .+?Constructor\]$/,Z=Object.prototype,W=Function.prototype.toString,Y=Z.hasOwnProperty,Q=RegExp("^"+W.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function X(t,e){var i=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!q(t)||(e=t,L&&L in e))&&(M(t)?Q:J).test(H(t));var e}(i)?i:void 0}var tt=X(S,"WeakMap"),et=9007199254740991,it=/^(?:0|[1-9]\d*)$/;function nt(t,e){var i=typeof t;return!!(e=e??et)&&("number"==i||"symbol"!=i&&it.test(t))&&t>-1&&t%1==0&&t<e}function rt(t,e){return t===e||t!=t&&e!=e}var ot=9007199254740991;function st(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=ot}var at=Object.prototype;function lt(t){return P(t)&&"[object Arguments]"==T(t)}var ct=Object.prototype,dt=ct.hasOwnProperty,ut=ct.propertyIsEnumerable,pt=lt(function(){return arguments}())?lt:function(t){return P(t)&&dt.call(t,"callee")&&!ut.call(t,"callee")},ft="object"==typeof exports&&exports&&!exports.nodeType&&exports,ht=ft&&"object"==typeof module&&module&&!module.nodeType&&module,gt=ht&&ht.exports===ft?S.Buffer:void 0,yt=(gt?gt.isBuffer:void 0)||function(){return!1},vt={};vt["[object Float32Array]"]=vt["[object Float64Array]"]=vt["[object Int8Array]"]=vt["[object Int16Array]"]=vt["[object Int32Array]"]=vt["[object Uint8Array]"]=vt["[object Uint8ClampedArray]"]=vt["[object Uint16Array]"]=vt["[object Uint32Array]"]=!0,vt["[object Arguments]"]=vt["[object Array]"]=vt["[object ArrayBuffer]"]=vt["[object Boolean]"]=vt["[object DataView]"]=vt["[object Date]"]=vt["[object Error]"]=vt["[object Function]"]=vt["[object Map]"]=vt["[object Number]"]=vt["[object Object]"]=vt["[object RegExp]"]=vt["[object Set]"]=vt["[object String]"]=vt["[object WeakMap]"]=!1;var bt,mt="object"==typeof exports&&exports&&!exports.nodeType&&exports,_t=mt&&"object"==typeof module&&module&&!module.nodeType&&module,$t=_t&&_t.exports===mt&&x.process,xt=function(){try{return _t&&_t.require&&_t.require("util").types||$t&&$t.binding&&$t.binding("util")}catch(t){}}(),jt=xt&&xt.isTypedArray,St=jt?(bt=jt,function(t){return bt(t)}):function(t){return P(t)&&st(t.length)&&!!vt[T(t)]},Ct=Object.prototype.hasOwnProperty;var wt=function(t,e){return function(i){return t(e(i))}}(Object.keys,Object),At=wt,zt=Object.prototype.hasOwnProperty;function Ot(t){return null!=(e=t)&&st(e.length)&&!M(e)?function(t,e){var i=N(t),n=!i&&pt(t),r=!i&&!n&&yt(t),o=!i&&!n&&!r&&St(t),s=i||n||r||o,a=s?function(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}(t.length,String):[],l=a.length;for(var c in t)!e&&!Ct.call(t,c)||s&&("length"==c||r&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||nt(c,l))||a.push(c);return a}(t):function(t){if(i=(e=t)&&e.constructor,e!==("function"==typeof i&&i.prototype||at))return At(t);var e,i,n=[];for(var r in Object(t))zt.call(t,r)&&"constructor"!=r&&n.push(r);return n}(t);var e}var kt=X(Object,"create"),It=Object.prototype.hasOwnProperty,Rt=Object.prototype.hasOwnProperty;function Et(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Tt(t,e){for(var i=t.length;i--;)if(rt(t[i][0],e))return i;return-1}Et.prototype.clear=function(){this.__data__=kt?kt(null):{},this.size=0},Et.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Et.prototype.get=function(t){var e=this.__data__;if(kt){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return It.call(e,t)?e[t]:void 0},Et.prototype.has=function(t){var e=this.__data__;return kt?void 0!==e[t]:Rt.call(e,t)},Et.prototype.set=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=kt&&void 0===e?"__lodash_hash_undefined__":e,this};var Pt=Array.prototype.splice;function Nt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}Nt.prototype.clear=function(){this.__data__=[],this.size=0},Nt.prototype.delete=function(t){var e=this.__data__,i=Tt(e,t);return!(i<0||(i==e.length-1?e.pop():Pt.call(e,i,1),--this.size,0))},Nt.prototype.get=function(t){var e=this.__data__,i=Tt(e,t);return i<0?void 0:e[i][1]},Nt.prototype.has=function(t){return Tt(this.__data__,t)>-1},Nt.prototype.set=function(t,e){var i=this.__data__,n=Tt(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this};var qt=X(S,"Map");function Ut(t,e){var i,n,r=t.__data__;return("string"==(n=typeof(i=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==i:null===i)?r["string"==typeof e?"string":"hash"]:r.map}function Dt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Bt(t){var e=this.__data__=new Nt(t);this.size=e.size}Dt.prototype.clear=function(){this.size=0,this.__data__={hash:new Et,map:new(qt||Nt),string:new Et}},Dt.prototype.delete=function(t){var e=Ut(this,t).delete(t);return this.size-=e?1:0,e},Dt.prototype.get=function(t){return Ut(this,t).get(t)},Dt.prototype.has=function(t){return Ut(this,t).has(t)},Dt.prototype.set=function(t,e){var i=Ut(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this},Bt.prototype.clear=function(){this.__data__=new Nt,this.size=0},Bt.prototype.delete=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},Bt.prototype.get=function(t){return this.__data__.get(t)},Bt.prototype.has=function(t){return this.__data__.has(t)},Bt.prototype.set=function(t,e){var i=this.__data__;if(i instanceof Nt){var n=i.__data__;if(!qt||n.length<199)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new Dt(n)}return i.set(t,e),this.size=i.size,this};var Vt=Object.prototype.propertyIsEnumerable,Mt=Object.getOwnPropertySymbols,Ft=Mt?function(t){return null==t?[]:function(e,i){for(var n=-1,r=null==e?0:e.length,o=0,s=[];++n<r;){var a=e[n];l=a,Vt.call(t,l)&&(s[o++]=a)}var l;return s}(Mt(t=Object(t)))}:function(){return[]};function Kt(t){return function(t,e,i){var n=Ot(t);return N(t)?n:function(t,e){for(var i=-1,n=e.length,r=t.length;++i<n;)t[r+i]=e[i];return t}(n,i(t))}(t,0,Ft)}var Lt=X(S,"DataView"),Gt=X(S,"Promise"),Ht=X(S,"Set"),Jt="[object Map]",Zt="[object Promise]",Wt="[object Set]",Yt="[object WeakMap]",Qt="[object DataView]",Xt=H(Lt),te=H(qt),ee=H(Gt),ie=H(Ht),ne=H(tt),re=T;(Lt&&re(new Lt(new ArrayBuffer(1)))!=Qt||qt&&re(new qt)!=Jt||Gt&&re(Gt.resolve())!=Zt||Ht&&re(new Ht)!=Wt||tt&&re(new tt)!=Yt)&&(re=function(t){var e=T(t),i="[object Object]"==e?t.constructor:void 0,n=i?H(i):"";if(n)switch(n){case Xt:return Qt;case te:return Jt;case ee:return Zt;case ie:return Wt;case ne:return Yt}return e});var oe=re,se=S.Uint8Array;function ae(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new Dt;++e<i;)this.add(t[e])}function le(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}ae.prototype.add=ae.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},ae.prototype.has=function(t){return this.__data__.has(t)};var ce=1,de=2;function ue(t,e,i,n,r,o){var s=i&ce,a=t.length,l=e.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(t),d=o.get(e);if(c&&d)return c==e&&d==t;var u=-1,p=!0,f=i&de?new ae:void 0;for(o.set(t,e),o.set(e,t);++u<a;){var h=t[u],g=e[u];if(n)var y=s?n(g,h,u,e,t,o):n(h,g,u,t,e,o);if(void 0!==y){if(y)continue;p=!1;break}if(f){if(!le(e,(function(t,e){if(s=e,!f.has(s)&&(h===t||r(h,t,i,n,o)))return f.push(e);var s}))){p=!1;break}}else if(h!==g&&!r(h,g,i,n,o)){p=!1;break}}return o.delete(t),o.delete(e),p}function pe(t){var e=-1,i=Array(t.size);return t.forEach((function(t,n){i[++e]=[n,t]})),i}function fe(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=t})),i}var he=1,ge=2,ye="[object Boolean]",ve="[object Date]",be="[object Error]",me="[object Map]",_e="[object Number]",$e="[object RegExp]",xe="[object Set]",je="[object String]",Se="[object Symbol]",Ce="[object ArrayBuffer]",we="[object DataView]",Ae=C?C.prototype:void 0,ze=Ae?Ae.valueOf:void 0,Oe=1,ke=Object.prototype.hasOwnProperty,Ie=1,Re="[object Arguments]",Ee="[object Array]",Te="[object Object]",Pe=Object.prototype.hasOwnProperty;function Ne(t,e,i,n,r){return t===e||(null==t||null==e||!P(t)&&!P(e)?t!=t&&e!=e:function(t,e,i,n,r,o){var s=N(t),a=N(e),l=s?Ee:oe(t),c=a?Ee:oe(e),d=(l=l==Re?Te:l)==Te,u=(c=c==Re?Te:c)==Te,p=l==c;if(p&&yt(t)){if(!yt(e))return!1;s=!0,d=!1}if(p&&!d)return o||(o=new Bt),s||St(t)?ue(t,e,i,n,r,o):function(t,e,i,n,r,o,s){switch(i){case we:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Ce:return!(t.byteLength!=e.byteLength||!o(new se(t),new se(e)));case ye:case ve:case _e:return rt(+t,+e);case be:return t.name==e.name&&t.message==e.message;case $e:case je:return t==e+"";case me:var a=pe;case xe:var l=n&he;if(a||(a=fe),t.size!=e.size&&!l)return!1;var c=s.get(t);if(c)return c==e;n|=ge,s.set(t,e);var d=ue(a(t),a(e),n,r,o,s);return s.delete(t),d;case Se:if(ze)return ze.call(t)==ze.call(e)}return!1}(t,e,l,i,n,r,o);if(!(i&Ie)){var f=d&&Pe.call(t,"__wrapped__"),h=u&&Pe.call(e,"__wrapped__");if(f||h){var g=f?t.value():t,y=h?e.value():e;return o||(o=new Bt),r(g,y,i,n,o)}}return!!p&&(o||(o=new Bt),function(t,e,i,n,r,o){var s=i&Oe,a=Kt(t),l=a.length;if(l!=Kt(e).length&&!s)return!1;for(var c=l;c--;){var d=a[c];if(!(s?d in e:ke.call(e,d)))return!1}var u=o.get(t),p=o.get(e);if(u&&p)return u==e&&p==t;var f=!0;o.set(t,e),o.set(e,t);for(var h=s;++c<l;){var g=t[d=a[c]],y=e[d];if(n)var v=s?n(y,g,d,e,t,o):n(g,y,d,t,e,o);if(!(void 0===v?g===y||r(g,y,i,n,o):v)){f=!1;break}h||(h="constructor"==d)}if(f&&!h){var b=t.constructor,m=e.constructor;b==m||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof m&&m instanceof m||(f=!1)}return o.delete(t),o.delete(e),f}(t,e,i,n,r,o))}(t,e,i,n,Ne,r))}function qe(t,e){return Ne(t,e)}const Ue=r`.material-icons{font-family:'Material Icons';font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased}`;var De=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Be=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};const Ve="\"'=!+#\\*~;\\^\\(\\)<>\\[\\],&",Me=`(?!\\d)[^${Ve}\\s]{1,20}`,Fe=RegExp(`^${Me}$`),Ke=`[^${Ve}]{1,40}`,Le=RegExp(`^${Ke}$`);let Ge=class extends o{constructor(){super(...arguments),this.dirtyConfig=[],this.title=""}set config(t){t&&!qe(t,this.clean(this.dirtyConfig))&&(this.dirtyConfig=[],t.forEach((t=>{this.dirtyConfig.push({id:Date.now(),targeting:t})})))}get config(){return this.clean(this.dirtyConfig)}clean(t){const e=[];return t.forEach((t=>{const{key:i,value:n}=t.targeting;if(i&&i.trim().length>0&&Fe.test(i.trim())){const t=(Array.isArray(n)?n:[n]).filter((t=>t&&t.trim().length>0&&Le.test(t)));t.length>0&&e.push({key:i,value:t.length>1?t:t[0]})}})),e}cloneConfig(){return structuredClone(this.dirtyConfig)}updateConfig(t){const e=!qe(this.clean(t),this.clean(this.dirtyConfig));this.dirtyConfig=t,e&&this.dispatchEvent(new CustomEvent("update",{bubbles:!0,composed:!0}))}addKey(){const t=this.cloneConfig();t.push({id:Date.now(),targeting:{key:"",value:""}}),this.focusIndex=t.length-1,this.updateConfig(t)}updateKey(t){const e=t.target.closest(".key-value"),i=Number(e.id),n=this.cloneConfig();n[i].targeting.key=t.target.value,this.updateConfig(n)}removeKey(t){const e=t.target.closest(".key-value"),i=Number(e.id),n=this.cloneConfig();n.splice(i,1),this.focusIndex=Math.max(i-1,0),this.updateConfig(n)}addValue(t){const e=t.target.closest(".key-value"),i=Number(e.id);let n=this.dirtyConfig[i].targeting.value;n=Array.isArray(n)?n:[n];const r=this.cloneConfig();r[i].targeting.value=[...n,""],this.focusIndex=i,this.updateConfig(r)}removeValue(t){const e=t.target.closest(".value"),i=e.querySelector("input"),n=e.closest(".key-value"),r=Number(n.id),o=this.cloneConfig();o[r].targeting.value=Array.from(n.querySelectorAll(".value input")).filter((t=>t!==i)).map((t=>t.value)),o[r].id=Date.now(),o[r].targeting.value&&0!==o[r].targeting.value.length?(this.focusIndex=r,this.updateConfig(o)):this.removeKey(t)}updateValue(t){const e=t.target.closest(".key-value"),i=Number(e.id),n=this.cloneConfig();n[i].targeting.value=Array.from(e.querySelectorAll(".value input")).map((t=>t.value)),this.updateConfig(n)}renderValues(t){const e=Array.isArray(t)?t:[t],i=[];return e.forEach(((t,n)=>{const r=n<e.length-1?s`<span class="spacer"></span>`:s`<span class="material-icons md-24 button" @click="${this.addValue}" title="${"Add targeting value"}">add</span>`;i.push(s`<div class="value"><input type="text" value="${t}" maxlength="40" pattern="${Ke}" @input="${this.updateValue}"> <span class="material-icons md-24 button" @click="${this.removeValue}" title="${"Remove targeting value"}">delete</span> ${r}</div>`)})),i}renderKeyValue(t,e){return s`${$(t.id,s`<div class="key-value" id="${e}"><div class="key"><input type="text" value="${t.targeting.key}" maxlength="20" pattern="${Me}" @input="${this.updateKey}"></div><div class="values">${this.renderValues(t.targeting.value)}</div></div>`)}`}render(){const t=[];return this.dirtyConfig.forEach(((e,i)=>{t.push(this.renderKeyValue(e,i))})),s`<fieldset><div class="header"><span>Key</span> <span>Values</span></div><legend>${this.title}</legend>${t} <span class="material-icons md-24 button add-key" @click="${this.addKey}" title="${"Add targeting key"}">add</span></fieldset>`}updated(){if(void 0===this.focusIndex)return;const t=this.renderRoot.querySelectorAll(".key-value")[this.focusIndex],e=t?.querySelector(".key input");if(0===e?.value.trim().length)e.focus();else{const e=t?.querySelector(".values"),i=e?.lastElementChild?.querySelector("input");0===i?.value.trim().length&&i.focus()}this.focusIndex=void 0}};Ge.styles=[Ue,r`:host{width:100%}fieldset{display:flex;flex-flow:row wrap}.header,.key-value{display:flex;flex-direction:row;width:100%}.header{margin:0 24px 0}.key-value{padding:5px;margin-left:24px}.key-value:nth-child(even){background-color:#a9a9a9}.header span,.key,.values{align-items:baseline;display:flex;flex:1;justify-content:center}.key,.values{flex-direction:column;flex:1;align-items:center;padding:5px}.key input,.value input{width:100%}.value{display:flex;justify-content:center;width:100%}.add-key{width:100%;text-align:center;margin:0 24px 0}.button{cursor:pointer}input:invalid{background-color:#ffb6c1}`],De([m(),Be("design:type",Array)],Ge.prototype,"dirtyConfig",void 0),De([t({attribute:"title",type:String}),Be("design:type",Object)],Ge.prototype,"title",void 0),De([t({attribute:"config",type:Array}),Be("design:type",Array),Be("design:paramtypes",[Array])],Ge.prototype,"config",null),Ge=De([e("targeting-input")],Ge);var He=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Je=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};const Ze="[\\d]{1,4}",We=RegExp(`^${Ze}$`);let Ye=class extends o{constructor(){super(...arguments),this.dirtyConfig=[],this.title=""}set config(t){t&&!qe(t,this.clean(this.dirtyConfig))&&(this.dirtyConfig=[],Array.isArray(t)?(t.length<=2&&!Array.isArray(t[0])?[t]:t).forEach((t=>{const e=Array.isArray(t)?1===t.length?t:[t[0]+"",t[1]+""]:[t];this.dirtyConfig.push({id:Date.now(),size:e})})):this.dirtyConfig.push({id:Date.now(),size:[t]}))}get config(){return this.clean(this.dirtyConfig)}clean(t){const e=[];return t.forEach((({size:t})=>{Array.isArray(t)?1==t.length&&t[0]?e.push(t[0]):We.test(t[0])&&We.test(t[1])&&e.push([Number(t[0]),Number(t[1])]):t&&e.push(t)})),1===e.length?e[0]:Array.from(e)}cloneConfig(){return structuredClone(this.dirtyConfig)}updateConfig(t){const e=!qe(this.clean(t),this.clean(this.dirtyConfig));this.dirtyConfig=t,e&&this.dispatchEvent(new CustomEvent("update",{bubbles:!0,composed:!0}))}isNamedSize(t){const e=["fluid"];return Array.isArray(t)?1==t.length&&e.includes(t[0]):e.includes(t)}size(t){if(t.querySelector("input[name=fluid]").checked)return["fluid"];{const e=t.querySelector("input[name=width]"),i=t.querySelector("input[name=height]");return[e.value,i.value]}}addSize(){const t=this.cloneConfig();t.push({id:Date.now()}),this.focusIndex=t.length-1,this.updateConfig(t)}removeSize(t){const e=this.cloneConfig(),i=t.target.closest(".size"),n=Array.from(this.renderRoot.querySelectorAll(".size")).indexOf(i);e.splice(n,1),this.focusIndex=Math.max(n-1,0),this.updateConfig(e)}updateSize(t){const e=this.cloneConfig(),i=t.target.closest(".size");e[Array.from(this.renderRoot.querySelectorAll(".size")).indexOf(i)].size=this.size(i),this.updateConfig(e)}renderDimensions(t){const e=t&&this.isNamedSize(t);return s`<div class="dimensions"><input type="text" maxLength="4" name="width" pattern="${Ze}" placeholder="${"Width"}" value="${!t||e?n:t[0]}" ?disabled="${e}" @input="${this.updateSize}"> <span class="dimension-separator">x</span> <input type="text" maxLength="4" name="height" pattern="${Ze}" placeholder="${"Height"}" value="${!t||e?n:t[1]}" ?disabled="${e}" @input="${this.updateSize}"></div>`}renderNamedSizes(t){const e=t&&this.isNamedSize(t);return s`<div class="fluid"><input name="fluid" type="checkbox" ?checked="${e}" @input="${this.updateSize}"> <label for="fluid">${"Fluid"}</label></div>`}renderSize(t){return s`${$(t.id,s`<div class="size"><div class="size-input">${this.renderDimensions(t.size)} ${this.renderNamedSizes(t.size)}</div><div class="size-controls"><span class="material-icons md-24 button" title="${"Remove size"}" @click="${this.removeSize}">delete</span></div></div>`)}`}render(){const t=[];return this.dirtyConfig.forEach((e=>{t.push(this.renderSize(e))})),s`<fieldset><legend>${this.title}</legend>${t} <span class="material-icons md-24 add-size button" title="${"Add size"}" @click="${this.addSize}">add</span></fieldset>`}updated(){if(void 0===this.focusIndex)return;const t=this.renderRoot.querySelectorAll(".size")[this.focusIndex];t?.querySelector("input[name=width]")?.focus(),this.focusIndex=void 0}};Ye.styles=[Ue,r`:host{width:100%}fieldset{display:flex;flex-flow:row wrap}.size{align-items:center;display:flex;flex-direction:row;margin:0 24px 0;padding:5px;width:100%}.size:nth-child(odd){background-color:#a9a9a9;color:#fff}.size:nth-child(odd) .material-icons{color:#000}.dimensions input,.size-input{flex:1}.size-controls{display:flex;align-self:flex-start}.dimensions{display:flex}.dimension-separator{padding:0 5px 0}.add-size{width:100%;text-align:center;margin:0 24px 0}.button{cursor:pointer}input:invalid{background-color:#ffb6c1}`],He([m(),Je("design:type",Array)],Ye.prototype,"dirtyConfig",void 0),He([t({attribute:"title",type:String}),Je("design:type",Object)],Ye.prototype,"title",void 0),He([t({attribute:"config",type:Array}),Je("design:type",Object),Je("design:paramtypes",[Object])],Ye.prototype,"config",null),Ye=He([e("slot-size-input")],Ye);
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const Qe=u(class extends p{constructor(t){if(super(t),t.type!==f.ATTRIBUTE||"class"!==t.name||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((e=>t[e])).join(" ")+" "}update(t,[e]){if(void 0===this.it){this.it=new Set,void 0!==t.strings&&(this.st=new Set(t.strings.join(" ").split(/\s/).filter((t=>""!==t))));for(const t in e)e[t]&&!this.st?.has(t)&&this.it.add(t);return this.render(e)}const i=t.element.classList;for(const t of this.it)t in e||(i.remove(t),this.it.delete(t));for(const t in e){const n=!!e[t];n===this.it.has(t)||this.st?.has(t)||(n?(i.add(t),this.it.add(t)):(i.remove(t),this.it.delete(t)))}return a}}),Xe=[{name:"Fixed-size ad (100x100)",slot:{adUnit:"/6355419/Travel/Europe",size:[100,100]}},{name:"Fixed-size ad (300x250)",slot:{adUnit:"/6355419/Travel/Europe",size:[300,250]}},{name:"Fixed-size ad (728x90)",slot:{adUnit:"/6355419/Travel/Europe",size:[728,90]}},{name:"Fixed-size ad (750x200)",slot:{adUnit:"/6355419/Travel/Europe",size:[750,200]}},{name:"Multi-size ad",slot:{adUnit:"/6355419/Travel/Europe",size:[[100,100],[300,250],[728,90],[750,200]]}},{name:"Fluid ad",slot:{adUnit:"/6355419/Travel",size:"fluid"}}];var ti=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},ei=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};const ii="[\\da-zA-Z_\\-.*\\/\\\\!:\\(\\)]+",ni=RegExp(`^${ii}$`);let ri=class extends o{constructor(){super(...arguments),this.dirtyConfig=[],this.title=""}set config(t){t&&!qe(t,this.clean(this.dirtyConfig))&&(this.dirtyConfig=[],t.forEach((t=>{this.dirtyConfig.push({id:Date.now(),slot:t,template:this.isTemplateAd(t)})})))}get config(){return this.clean(this.dirtyConfig)}clean(t){const e=[];return t.forEach((({slot:t})=>{t.adUnit&&t.size.length>0&&ni.test(t.adUnit)&&e.push(t)})),e}cloneConfig(){return structuredClone(this.dirtyConfig)}updateConfig(t){const e=!qe(this.clean(t),this.clean(this.dirtyConfig));this.dirtyConfig=t,e&&(console.log(JSON.stringify(this.dirtyConfig)),this.dispatchEvent(new CustomEvent("update",{bubbles:!0,composed:!0})))}isTemplateAd(t){return Xe.filter((e=>qe(t,e.slot))).length>0}addSlot(){const t=this.cloneConfig();t.push({id:Date.now(),slot:Xe[0].slot,template:!0}),this.updateConfig(t)}removeSlot(t){const e=this.cloneConfig(),i=t.target.closest(".slot"),n=Array.from(this.renderRoot.querySelectorAll(".slot")).indexOf(i);e.splice(n,1),this.updateConfig(e)}updateSlot(t){const e=this.cloneConfig(),i=t.target.closest(".slot"),n=Array.from(this.renderRoot.querySelectorAll(".slot")).indexOf(i),r=i.querySelector("select").selectedOptions[0];r.dataset&&r.dataset.index?(e[n].template=!0,e[n].slot=Xe[Number(r.dataset.index)].slot):(e[n].template=!1,e[n].slot={adUnit:i.querySelector("input[name=adUnit]").value,size:i.querySelector("slot-size-input").config,targeting:i.querySelector("targeting-input").config}),this.updateConfig(e)}renderSlotTemplates(t){const e=[];return Xe.forEach(((i,n)=>{const r=s`<option data-index="${n}" ?selected="${qe(t,i.slot)}">${i.name}</option>`;e.push(r)})),s`<select class="flex padded" @input="${this.updateSlot}"><option>${"Custom"}</option><optgroup label="${"Sample Ads"}">${e}</optgroup></select>`}renderSlotOptions(t){return s`<div class="slot-option flex"><label for="adUnit">${"Ad unit path"}</label> <input class="flex" type="text" name="adUnit" pattern="${ii}" value="${t.adUnit}" @input="${this.updateSlot}"></div>`}renderSlotSizeInput(t){return s`<slot-size-input title="${"Sizes"}" .config="${t.size}" @update="${this.updateSlot}"></slot-size-input>`}renderTargetingInput(t){return s`<targeting-input title="${"Targeting"}" .config="${t.targeting}" @update="${this.updateSlot}"></targeting-input>`}renderSlotSettings(t,e){const i={row:!0,hidden:e},n={...i,padded:!0};return s`<div class="${Qe(n)}">${this.renderSlotOptions(t)}</div><div class="${Qe(i)}">${this.renderSlotSizeInput(t)}</div><div class="${Qe(i)}">${this.renderTargetingInput(t)}</div>`}renderSlot(t,e){return s`<div class="slot flex"><span class="slot-id">${e+1}</span><div class="slot-settings flex">${this.renderSlotTemplates(t.slot)} <span class="material-icons md-24 button" title="${"Remove slot"}" @click="${this.removeSlot}">delete</span> ${this.renderSlotSettings(t.slot,t.template)}</div></div>`}render(){const t=[];return this.dirtyConfig.forEach(((e,i)=>{t.push(this.renderSlot(e,i))})),s`<fieldset><legend>${this.title}</legend>${t} <span class="material-icons md-24 add-slot button" title="${"Add slot"}" @click="${this.addSlot}">add</span></fieldset>`}};ri.styles=[Ue,r`:host{width:100%}fieldset{display:flex;flex-flow:column wrap;margin:15px 0 0}.slot{padding:10px}.slot:nth-child(odd){background-color:#d3d3d3}.slot-id{flex:0 1;align-self:center;min-width:24px}.slot-option label{padding-right:5px}.add-slot{margin:0 24px 0;text-align:center}.button{cursor:pointer}.flex{display:flex;flex:1;flex-flow:row wrap}.row{flex:0 1 100%}.hidden{display:none}.padded{padding:5px}input:invalid{background-color:#ffb6c1}`],ti([m(),ei("design:type",Array)],ri.prototype,"dirtyConfig",void 0),ti([t({attribute:"title",type:String}),ei("design:type",Object)],ri.prototype,"title",void 0),ti([t({attribute:"config",type:Array}),ei("design:type",Array),ei("design:paramtypes",[Array])],ri.prototype,"config",null),ri=ti([e("slot-input")],ri);
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const oi=(t,e)=>{const i=t._$AN;if(void 0===i)return!1;for(const t of i)t._$AO?.(e,!1),oi(t,e);return!0},si=t=>{let e,i;do{if(void 0===(e=t._$AM))break;i=e._$AN,i.delete(t),t=e}while(0===i?.size)},ai=t=>{for(let e;e=t._$AM;t=e){let i=e._$AN;if(void 0===i)e._$AN=i=new Set;else if(i.has(t))break;i.add(t),di(e)}};function li(t){void 0!==this._$AN?(si(this),this._$AM=t,ai(this)):this._$AM=t}function ci(t,e=!1,i=0){const n=this._$AH,r=this._$AN;if(void 0!==r&&0!==r.size)if(e)if(Array.isArray(n))for(let t=i;t<n.length;t++)oi(n[t],!1),si(n[t]);else null!=n&&(oi(n,!1),si(n));else oi(this,t)}const di=t=>{t.type==f.CHILD&&(t._$AP??=ci,t._$AQ??=li)};class ui extends p{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,e,i){super._$AT(t,e,i),ai(this),this.isConnected=t._$AU}_$AO(t,e=!0){t!==this.isConnected&&(this.isConnected=t,t?this.reconnected?.():this.disconnected?.()),e&&(oi(this,t),si(this))}setValue(t){if((t=>void 0===this._$Ct.strings)())this._$Ct._$AI(t,this);else{const e=[...this._$Ct._$AH];e[this._$Ci]=t,this._$Ct._$AI(e,this,0)}}disconnected(){}reconnected(){}}
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class pi{constructor(t){this.G=t}disconnect(){this.G=void 0}reconnect(t){this.G=t}deref(){return this.G}}class fi{constructor(){this.Y=void 0,this.Z=void 0}get(){return this.Y}pause(){this.Y??=new Promise((t=>this.Z=t))}resume(){this.Z?.(),this.Y=this.Z=void 0}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const hi=t=>!(t=>null===t||"object"!=typeof t&&"function"!=typeof t)(t)&&"function"==typeof t.then,gi=1073741823,yi=u(class extends ui{constructor(){super(...arguments),this._$C_t=gi,this._$Cwt=[],this._$Cq=new pi(this),this._$CK=new fi}render(...t){return t.find((t=>!hi(t)))??a}update(t,e){const i=this._$Cwt;let n=i.length;this._$Cwt=e;const r=this._$Cq,o=this._$CK;this.isConnected||this.disconnected();for(let t=0;t<e.length&&!(t>this._$C_t);t++){const s=e[t];if(!hi(s))return this._$C_t=t,s;t<n&&s===i[t]||(this._$C_t=gi,n=0,Promise.resolve(s).then((async t=>{for(;o.get();)await o.get();const e=r.deref();if(void 0!==e){const i=e._$Cwt.indexOf(s);i>-1&&i<e._$C_t&&(e._$C_t=i,e.setValue(t))}})))}return a}disconnected(){this._$Cq.disconnect(),this._$CK.pause()}reconnected(){this._$Cq.reconnect(this),this._$CK.resume()}});var vi=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},bi=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let mi=class extends o{set config(t){this.internalConfig=t,this.template=g(t)}get config(){return this.internalConfig}constructor(){super(),this.internalConfig={slots:[]},this.template=g(this.config)}getInputById(t){return this.renderRoot.querySelector("#"+t)}getSelectById(t){return this.renderRoot.querySelector("#"+t)}updateBooleanSettings(t){const e=structuredClone(this.config);e.page=e.page||{},e.page.privacy=e.page.privacy||{},e.page.sra=this.getInputById("sra").checked;const i=e.page.privacy;i.ltd=this.getInputById("ltd").checked,i.npa=this.getInputById("npa").checked,i.rdp=this.getInputById("rdp").checked,i.tfcd=this.getInputById("tfcd").checked,i.tfua=this.getInputById("tfua").checked,this.config=e}updateStringSettings(t){const e=structuredClone(this.config);e.template=e.template||{};const i=e.template,n=this.getSelectById("target").value;i.target=n.length>0?y.ScriptTarget[n]:void 0,this.config=e}updatePageTargeting(t){const e=structuredClone(this.config);e.page=e.page||{},e.page.targeting=this.pageTargetingInput.config,this.config=e}updateSlotSettings(t){const e=structuredClone(this.config);e.slots=e.slots||[],e.slots=this.slotInput.config,this.config=e}checkbox(t,e,i=!1){return s`<div><input type="checkbox" id="${t}" ?checked="${i}" @click="${this.updateBooleanSettings}"> <label for="${t}">${e}</label></div>`}renderPageSettings(){const t=this.config?.page;return s`<fieldset class="page"><legend>${"Page settings"}</legend>${this.checkbox("sra","Single Request Architecture (SRA)",t?.sra)} ${this.renderPrivacySettings()}<targeting-input class="page" .config="${t?.targeting}" title="${"Page-level targeting"}" @update="${this.updatePageTargeting}"></targeting-input></fieldset>`}renderPrivacySettings(){const t=this.config?.page?.privacy;return s`<fieldset class="privacy"><legend>${"Privacy"}</legend>${this.checkbox("tfcd","Child-directed treatment",t?.tfcd)} ${this.checkbox("ltd","Limited ads",t?.ltd)} ${this.checkbox("npa","Non-personalized ads",t?.npa)} ${this.checkbox("rdp","Restrict data processing",t?.rdp)} ${this.checkbox("tfua","Under the age of consent",t?.tfua)}</fieldset>`}renderSlotSettings(){return s`<slot-input title="${"Slot settings"}" .config="${this.config?.slots}" @update="${this.updateSlotSettings}"></slot-input>`}renderTemplateSettings(){const t=this.config?.template,e=[];return Object.entries(y.ScriptTarget).filter((([t,e])=>isNaN(Number(t))&&!["ES3","JSON"].includes(t))).forEach((([i,n])=>{e.push(s`<option value="${i}" ?selected="${t&&t.target===n}">JavaScript (${i})</option>`)})),s`<fieldset class="template"><legend>${"Output settings"}</legend><div><select id="target" name="target" @change="${this.updateStringSettings}"><option value="">TypeScript</option>${e}</select> <label for="target">${"Output format"}</label></div></fieldset>`}renderConfigurator(){return s`<div id="configurator"><div id="configurator-header"><span>Sample configuration</span></div><div id="configurator-settings">${this.renderPageSettings()} ${this.renderSlotSettings()} ${this.renderTemplateSettings()}</div></div>`}render(){return s`${this.renderConfigurator()}<gpt-playground .config="${yi(this.template?.playgroundConfig(),null)}" preview-enabled readonly="readonly" vertical></gpt-playground>`}updated(){l("config",v(JSON.stringify(this.config)))}};mi.styles=r`:host{display:flex;height:100%}#configurator{display:flex;flex-direction:column;width:var(--configurator-width,33%);background-color:var(--playground-tab-bar-background,#eaeaea)}#configurator-header{align-items:center;display:flex;flex:0 0 var(--playground-bar-height,40px);padding:0 8px 0;border-bottom:var(--playground-border,solid 1px #ddd)}#configurator-settings{flex:1 1 0%;max-height:100%;padding:0 8px 8px;overflow:scroll}fieldset{display:flex;flex-flow:row wrap}fieldset>fieldset,fieldset>targeting-input{margin:15px 0 0}fieldset label{display:block}fieldset input[type=checkbox]{float:left}fieldset select{float:right}fieldset.page div,fieldset.privacy div{width:33%;min-width:200px}fieldset.template div{width:50%;min-width:200px}`,vi([m(),bi("design:type",h)],mi.prototype,"template",void 0),vi([i("targeting-input.page"),bi("design:type",Ge)],mi.prototype,"pageTargetingInput",void 0),vi([i("slot-input"),bi("design:type",ri)],mi.prototype,"slotInput",void 0),vi([t({attribute:"config",type:Object}),bi("design:type",Object),bi("design:paramtypes",[Object])],mi.prototype,"config",null),mi=vi([e("sample-configurator"),bi("design:paramtypes",[])],mi);const _i=c("config"),$i=_i?JSON.parse(b(_i)):{slots:[]};d(s`<sample-configurator .config="${$i}"></sample-configurator>`,document.body);
